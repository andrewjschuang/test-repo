<!DOCTYPE html>
<html>
  <head>
    <title>Text File Viewer</title>
    <!-- Add some basic styling here or link to your CSS file -->
    <style>
      /* Add your CSS styling here */
      body {
        font-family: Arial, sans-serif;
      }
      #fileList {
        margin-top: 20px;
      }
      .file-name {
        cursor: pointer;
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <h1>Text File Viewer</h1>
    <input type="text" id="filterInput" placeholder="Filter files..." />
    <div id="fileList"></div>
    <div id="fileContent"></div>
    <button id="copyButton" style="display: none">Copy Content</button>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const repoOwner = "andrewjschuang";
        const repoName = "test-repo";
        const fileList = document.getElementById("fileList");
        const filterInput = document.getElementById("filterInput");
        const fileContent = document.getElementById("fileContent");
        const copyButton = document.getElementById("copyButton");

        async function fetchFiles() {
          const response = await fetch(
            `https://api.github.com/repos/${repoOwner}/${repoName}/contents/`
          );
          const data = await response.json();
          return data.filter((file) => file.name.endsWith(".txt"));
        }

        async function displayFiles() {
          const files = await fetchFiles();
          files.forEach((file) => {
            const div = document.createElement("div");
            div.className = "file-name";
            div.textContent = file.name;
            div.onclick = () => fetchFileContent(file.path);
            fileList.appendChild(div);
          });
        }

        async function fetchFileContent(path) {
          const response = await fetch(
            `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${path}`
          );
          const data = await response.json();
          const content = atob(data.content);
          fileContent.textContent = content;
          copyButton.style.display = "block";
          copyButton.onclick = () => navigator.clipboard.writeText(content);
        }

        filterInput.oninput = function () {
          const value = this.value.toLowerCase();
          const files = fileList.getElementsByClassName("file-name");
          for (let i = 0; i < files.length; i++) {
            if (files[i].textContent.toLowerCase().includes(value)) {
              files[i].style.display = "";
            } else {
              files[i].style.display = "none";
            }
          }
        };

        displayFiles();
      });
    </script>
  </body>
</html>
